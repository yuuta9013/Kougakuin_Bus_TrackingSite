<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>トレーディングカードゲーム</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }

        .game {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80vh;
        }

        #cardContainer, #shopContainer {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .card {
            border: 2px solid #444;
            border-radius: 10px;
            width: 150px;
            margin: 10px;
            padding: 10px;
            text-align: center;
            background-color: #f8f8f8;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .card img {
            width: 100%;
            height: auto;
            border-radius: 5px;
        }

        .card h3 {
            margin: 10px 0;
            font-size: 18px;
        }

        .card p {
            margin: 5px 0;
            font-size: 14px;
        }

        #startButton, #shopButton {
            width: 200px;
            height: 50px;
            font-size: 20px;
            margin-top: 10px;
        }

        #currencyDisplay {
            font-size: 18px;
            margin-top: 10px;
        }

        #battleField {
            margin-top: 20px;
            border: 2px solid #444;
            padding: 20px;
            width: 80%;
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <header>
        <button class="menu-btn" onclick="toggleMenu()">☰</button>
        <nav id="menu" style="display: none;">
            <ul>
                <li><a href="index.html">位置情報</a></li><br>
                <li><a href="notification.html">お知らせ</a></li><br>
                <li><a href="home.html">ミニゲーム</a></li><br>
                <li><a href="https://www.neec.ac.jp/hachioji/" target="_blank">学校ホームページ</a></li>
            </ul>
        </nav>
    </header>

    <section class="game">
        <h1>トレーディングカードゲーム</h1>
        <p>カードを集めてデッキを作り、戦おう！</p>
        <div id="currencyDisplay">ゲーム内通貨: 0G</div>
        <button id="startButton" onclick="startGame()">ゲーム開始</button>
        <button id="shopButton" onclick="openShop()">ショップ</button>
        <div id="cardContainer"></div>
        <div id="battleField" style="display:none;"></div>
        <div id="shopContainer" style="display:none;"></div>
    </section>

    <script>
        const cardContainer = document.getElementById('cardContainer');
        const shopContainer = document.getElementById('shopContainer');
        const battleField = document.getElementById('battleField');
        const currencyDisplay = document.getElementById('currencyDisplay');

        let currency = 0;
        let playerDeck = [];
        let enemyDeck = [];
        let battleDecks = {
            player: [],
            enemy: []
        };
        let currentPlayerCard = null;
        let currentEnemyCard = null;

        const elements = {
            fire: '火',
            water: '水',
            grass: '草'
        };

        const cards = [
            {
                name: "ファイアドラゴン",
                image: "https://via.placeholder.com/150",
                description: "炎を操るドラゴン。",
                attack: 80,
                defense: 50,
                hp: 100,
                element: elements.fire
            },
            {
                name: "ウォーターナイト",
                image: "https://via.placeholder.com/150",
                description: "水の力を使う騎士。",
                attack: 50,
                defense: 80,
                hp: 100,
                element: elements.water
            },
            // 新しいカードを追加
            /*
            {
                name: "カード名",
                image: "カードの画像URL",
                description: "カードの説明文",
                attack: 攻撃力（数値）,
                defense: 防御力（数値）,
                hp: HP（数値）,
                element: 属性（火、水、草など）
            },
            */
        ];

        const shopCards = [
            {
                name: "グラスビースト",
                image: "https://via.placeholder.com/150",
                description: "草の力を宿した獣。",
                attack: 60,
                defense: 60,
                hp: 100,
                element: elements.grass,
                price: 100
            },
            // 新しいカードを追加
            /*
            {
                name: "カード名",
                image: "カードの画像URL",
                description: "カードの説明文",
                attack: 攻撃力（数値）,
                defense: 防御力（数値）,
                hp: HP（数値）,
                element: 属性（火、水、草など）,
                price: 価格（数値）
            },
            */
        ];

        const enemyDecks = [
            [
                {
                    name: "エネミーファイア",
                    image: "https://via.placeholder.com/150",
                    description: "炎のモンスター。",
                    attack: 70,
                    defense: 60,
                    hp: 100,
                    element: elements.fire
                }
            ],
            // 管理者が追加可能
            /*
            [
                {
                    name: "カード名",
                    image: "カードの画像URL",
                    description: "カードの説明文",
                    attack: 攻撃力（数値）,
                    defense: 防御力（数値）,
                    hp: HP（数値）,
                    element: 属性（火、水、草など）
                }
            ],
            */
        ];

        function toggleMenu() {
            const menu = document.getElementById("menu");
            menu.style.display = menu.style.display === "none" ? "block" : "none";
        }

        function startGame() {
            cardContainer.innerHTML = ''; 
            battleField.style.display = 'block';
            prepareBattle();
        }

        function openShop() {
            shopContainer.innerHTML = '';
            shopContainer.style.display = 'block';
            displayShop(shopCards);
        }

        function displayShop(shopCards) {
            shopCards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('card');
                cardElement.innerHTML = `
                    <img src="${card.image}" alt="${card.name}">
                    <h3>${card.name}</h3>
                    <p>${card.description}</p>
                    <p><strong>攻撃力:</strong> ${card.attack}</p>
                    <p><strong>防御力:</strong> ${card.defense}</p>
                    <p><strong>HP:</strong> ${card.hp}</p>
                    <p><strong>属性:</strong> ${card.element}</p>
                    <p><strong>価格:</strong> ${card.price}G</p>
                    <button onclick="buyCard(${JSON.stringify(card)})">購入</button>
                `;
                shopContainer.appendChild(cardElement);
            });
        }

        function buyCard(card) {
            if (currency >= card.price) {
                currency -= card.price;
                playerDeck.push(card);
                updateCurrencyDisplay();
                alert(`${card.name} を購入しました！`);
            } else {
                alert("通貨が不足しています！");
            }
        }

        function updateCurrencyDisplay() {
            currencyDisplay.textContent = `ゲーム内通貨: ${currency}G`;
        }

        function prepareBattle() {
            alert("バトルを準備中...");
            // 現在は簡単なデモ、バトルロジックをここに追加可能
            <script>
    const elementAdvantages = {
        fire: { grass: 1.5, water: 0.5, fire: 1.0 },
        water: { fire: 1.5, grass: 0.5, water: 1.0 },
        grass: { water: 1.5, fire: 0.5, grass: 1.0 }
    };

    function prepareBattle() {
        battleDecks.player = [...playerDeck].slice(0, 4); // バトルデッキ：1枚バトル場、3枚控え
        battleDecks.enemy = enemyDecks[0].slice(0, 4); // サンプルデッキから選択
        currentPlayerCard = battleDecks.player.shift();
        currentEnemyCard = battleDecks.enemy.shift();
        displayBattleField();
        startBattle();
    }

    function displayBattleField() {
        battleField.innerHTML = `
            <div>
                <h3>プレイヤーのカード</h3>
                <div>${renderCard(currentPlayerCard)}</div>
            </div>
            <div>
                <h3>敵のカード</h3>
                <div>${renderCard(currentEnemyCard)}</div>
            </div>
        `;
    }

    function renderCard(card) {
        return `
            <div class="card">
                <img src="${card.image}" alt="${card.name}">
                <h3>${card.name}</h3>
                <p>${card.description}</p>
                <p><strong>攻撃力:</strong> ${card.attack}</p>
                <p><strong>防御力:</strong> ${card.defense}</p>
                <p><strong>HP:</strong> ${card.hp}</p>
                <p><strong>属性:</strong> ${card.element}</p>
            </div>
        `;
    }

    function startBattle() {
        let turn = "player";
        const battleInterval = setInterval(() => {
            if (turn === "player") {
                attack(currentPlayerCard, currentEnemyCard);
                turn = "enemy";
            } else {
                attack(currentEnemyCard, currentPlayerCard);
                turn = "player";
            }

            displayBattleField();

            if (currentPlayerCard.hp <= 0) {
                if (battleDecks.player.length > 0) {
                    currentPlayerCard = battleDecks.player.shift();
                } else {
                    alert("敵の勝利！");
                    clearInterval(battleInterval);
                    return;
                }
            }

            if (currentEnemyCard.hp <= 0) {
                if (battleDecks.enemy.length > 0) {
                    currentEnemyCard = battleDecks.enemy.shift();
                } else {
                    alert("プレイヤーの勝利！ 通貨を獲得しました！");
                    currency += 100; // 勝利報酬
                    updateCurrencyDisplay();
                    clearInterval(battleInterval);
                    return;
                }
            }
        }, 2000);
    }

    function attack(attacker, defender) {
        const advantage = elementAdvantages[attacker.element][defender.element];
        const damage = Math.max(0, attacker.attack * advantage - defender.defense);
        defender.hp -= damage;

        alert(`${attacker.name} が ${defender.name} に ${damage.toFixed(1)} のダメージを与えた！`);
    }
</script>

        }

        // 初期化
        updateCurrencyDisplay();
        displayShop(shopCards);
    </script>
</body>
</html>
