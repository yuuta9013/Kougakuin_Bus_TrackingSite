<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>迷路脱出ゲーム</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f9f9f9;
            margin: 0;
            padding: 0;
        }
        .game {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        #mazeArea {
            width: 300px;
            height: 300px;
            background-color: #e0e0e0;
            position: relative;
            border: 2px solid black;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(10, 1fr);
            gap: 2px;
        }
        .cell {
            width: 100%;
            height: 100%;
            background-color: white;
            border-radius: 2px;
        }
        .wall {
            background-color: black;
        }
        .player {
            background-color: blue;
        }
        .goal {
            background-color: green;
        }
        #statusDisplay {
            font-size: 1.2em;
            margin: 10px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin-top: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <section class="game">
        <h1>迷路脱出ゲーム</h1>
        <p>スワイプでプレイヤーを操作して、ゴールを目指そう！</p>
        <div id="mazeArea"></div>
        <p id="statusDisplay">プレイヤーをゴールに導こう！</p>
        <button onclick="startGame()">ゲーム開始</button>
    </section>

    <script>
        const mazeArea = document.getElementById('mazeArea');
        const mazeSize = 10; // 10x10の迷路
        let playerPosition = { x: 0, y: 0 }; // プレイヤーの初期位置
        let goalPosition = { x: 9, y: 9 }; // ゴールの位置
        let maze = []; // 迷路データ

        function startGame() {
            playerPosition = { x: 0, y: 0 };
            generateMaze();
            renderMaze();
            document.getElementById('statusDisplay').innerText = 'プレイヤーをゴールに導こう！';
        }

        function generateMaze() {
            maze = Array.from({ length: mazeSize }, () =>
                Array.from({ length: mazeSize }, () => (Math.random() > 0.7 ? 'wall' : 'cell'))
            );
            maze[0][0] = 'player'; // プレイヤーの位置
            maze[goalPosition.y][goalPosition.x] = 'goal'; // ゴールの位置
        }

        function renderMaze() {
            mazeArea.innerHTML = '';
            maze.forEach((row, y) => {
                row.forEach((cell, x) => {
                    const div = document.createElement('div');
                    div.className = `cell ${cell}`;
                    if (playerPosition.x === x && playerPosition.y === y) {
                        div.classList.add('player');
                    }
                    mazeArea.appendChild(div);
                });
            });
        }

        function movePlayer(dx, dy) {
            const newX = playerPosition.x + dx;
            const newY = playerPosition.y + dy;

            if (newX >= 0 && newX < mazeSize && newY >= 0 && newY < mazeSize) {
                if (maze[newY][newX] !== 'wall') {
                    playerPosition = { x: newX, y: newY };
                    if (newX === goalPosition.x && newY === goalPosition.y) {
                        document.getElementById('statusDisplay').innerText = 'ゴールしました！おめでとう！';
                        return;
                    }
                    renderMaze();
                }
            }
        }

        // スワイプ操作
        let touchStartX = 0;
        let touchStartY = 0;

        mazeArea.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
        });

        mazeArea.addEventListener('touchend', (e) => {
            const touch = e.changedTouches[0];
            const deltaX = touch.clientX - touchStartX;
            const deltaY = touch.clientY - touchStartY;

            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                if (deltaX > 0) movePlayer(1, 0); // 右
                else movePlayer(-1, 0); // 左
            } else {
                if (deltaY > 0) movePlayer(0, 1); // 下
                else movePlayer(0, -1); // 上
            }
        });
    </script>
</body>
</html>
